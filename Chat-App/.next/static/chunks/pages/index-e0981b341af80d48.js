(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(458)}])},458:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var n=s(5893),i=s(7294),a=s(9008),r=s.n(a),l=e=>(0,n.jsxs)(i.Fragment,{children:[(0,n.jsxs)(r(),{children:[(0,n.jsx)("meta",{charSet:"utf-8"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, shrink-to-fit=no"}),(0,n.jsx)("link",{rel:"stylesheet",href:"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css",integrity:"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm",crossOrigin:"anonymous"}),(0,n.jsx)("title",{children:e.pageTitle||"Realtime Chat"})]}),e.children]}),o=s(5121),c=s(6606),h=s.n(c);class d extends i.Component{render(){let{position:e="left",message:t}=this.props,s="right"===e.toLowerCase();return(0,n.jsx)("div",{className:"w-100 my-1 d-flex ".concat(s?"justify-content-end":"justify-content-start"),children:(0,n.jsx)("div",{className:"bg-light rounded border border-gray p-2",style:{maxWidth:"70%",flexGrow:0},children:(0,n.jsx)("span",{className:"d-block text-secondary ".concat(s?"text-right":"text-left"),style:{fontWeight:500,lineHeight:1.4,whiteSpace:"pre-wrap"},children:t})})})}}let p=[55357,56864],m=[55357,56832],x=[55357,56848];class u extends i.Component{componentDidMount(){this.pusher=new(h())("aeab31c8d8485d682474",{cluster:"us3",encrypted:!0}),this.channel=this.pusher.subscribe("chat-room"),this.channel.bind("new-message",e=>{let{chat:t=null}=e,{chats:s}=this.state;t&&s.push(t),this.setState({chats:s})}),this.pusher.connection.bind("connected",()=>{o.Z.post("/messages").then(e=>{let t=e.data.messages;this.setState({chats:t})})})}componentWillUnmount(){this.pusher.disconnect()}render(){return this.props.activeUser&&(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)("div",{className:"border-bottom border-gray w-100 d-flex align-items-center bg-white",style:{height:90},children:(0,n.jsx)("h2",{className:"text-dark mb-0 mx-4 px-2",children:this.props.activeUser})}),(0,n.jsx)("div",{className:"px-4 pb-4 w-100 d-flex flex-row flex-wrap align-items-start align-content-start position-relative",style:{height:"calc(100% - 180px)",overflowY:"scroll"},children:this.state.chats.map((e,t)=>{let s=Math.max(0,t-1),a=this.state.chats[s],r=e.user===this.props.activeUser?"right":"left",l=e.user===a.user,o=Math.ceil((e.timestamp-a.timestamp)/6e4)>1,c=e.sentiment>0?m:0===e.sentiment?x:p;return(0,n.jsxs)(i.Fragment,{children:[(s===t||!l||o)&&(0,n.jsxs)("div",{className:"d-block w-100 font-weight-bold text-dark mt-4 pb-1 px-1 text-".concat(r),style:{fontSize:"0.9rem"},children:[(0,n.jsx)("span",{className:"d-block",style:{fontSize:"1.6rem"},children:String.fromCodePoint(...c)}),(0,n.jsx)("span",{children:e.user||"Anonymous"})]}),(0,n.jsx)(d,{message:e.message,position:r})]},t)})}),(0,n.jsx)("div",{className:"border-top border-gray w-100 px-4 d-flex align-items-center bg-light",style:{minHeight:90},children:(0,n.jsx)("textarea",{className:"form-control px-3 py-2",onKeyUp:this.handleKeyUp,placeholder:"Enter a chat message",style:{resize:"none"}})})]})}constructor(...e){super(...e),this.state={chats:[]},this.handleKeyUp=e=>{let t=e.target.value;if(13===e.keyCode&&!e.shiftKey){let{activeUser:s}=this.props,n={user:s,message:t,timestamp:+new Date};e.target.value="",o.Z.post("/message",n)}}}}class g extends i.Component{render(){let{user:e}=this.state;return(0,n.jsx)(l,{pageTitle:"Realtime Chat",children:(0,n.jsx)("main",{className:"container-fluid position-absolute h-100 bg-dark",children:(0,n.jsxs)("div",{className:"row position-absolute w-100 h-100",children:[(0,n.jsx)("section",{className:"col-md-8 d-flex flex-row flex-wrap align-items-center align-content-center px-5",children:(0,n.jsxs)("div",{className:"px-5 mx-5",children:[(0,n.jsx)("span",{className:"d-block w-100 h1 text-light",style:{marginTop:-50},children:e?(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{style:{color:"#999"},children:"Hello!"})," ",e]}):"What is your name?"}),!e&&(0,n.jsx)("input",{type:"text",className:"form-control mt-3 px-3 py-2",onKeyUp:this.handleKeyUp,autoComplete:"off",style:{background:"transparent",color:"#999",border:0,borderBottom:"1px solid #666",borderRadius:0,fontSize:"3rem",fontWeight:500,boxShadow:"none !important"}})]})}),(0,n.jsx)("section",{className:"col-md-4 position-relative d-flex flex-wrap h-100 align-items-start align-content-between bg-white px-0",children:e&&(0,n.jsx)(u,{activeUser:e})})]})})})}constructor(...e){super(...e),this.state={user:null},this.handleKeyUp=e=>{if(13===e.keyCode){let t=e.target.value;this.setState({user:t})}}}}var f=()=>(0,n.jsx)(g,{})}},function(e){e.O(0,[837,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);